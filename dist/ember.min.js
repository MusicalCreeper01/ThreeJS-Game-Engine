function Ember(a,b){if(void 0==THREE)return console.error("Three.js isn't loaded!"),{};82>THREE.REVISION&&console.warn("Ember is tested with Three.js version >82, you are using "+THREE.REVISION+". Things may break if there have been API changes, please be careful!");var c=this;this.element=a;this.name="My New Ember Game";if(void 0!=b&&b.save)for(var d in b)this[d]=b[d];this["super"]=function(){};this.scenes=[];this.scene={};this.SceneManager=new function(){this.load=function(a){void 0==c.three?console.error("Three.js is not initialized, call Ember.begin() before loading scenes"):
isNaN(a)?c.scenes.forEach(function(b){b.name==a&&this._load(c.scenes[b])}):this._load(c.scenes[a])};this._load=function(a){void 0!=c.scene&&void 0!=c.scene.Events&&(c.scene.Events.ObjectAdded=[]);c.scene=a;if(2<c.three.scene.children.length){console.log("Clearing previous scene");for(var b=c.three.scene.children.length;2<=b;b--)void 0!=c.three.scene.children[b]&&c.three.scene.remove(c.three.scene.children[b])}if(void 0!=a.objects)for(console.log("Adding "+a.objects.length+" objects from new scene"),
b=0;b<a.objects.length;++b)console.log(a.objects[b]._tmesh()),c.three.scene.add(a.objects[b]._tmesh());c.scene.Events.ObjectAdded.push(function(a){c.three.scene.add(a._tmesh())})};this.add=function(a){c.scenes.push(a)}};this.begin=function(){function a(){requestAnimationFrame(a);f.updateProjectionMatrix();e.setViewport(0,0,b,d);e.render(g,f)}c.three={};var b=c.element.offsetWidth,d=c.element.offsetHeight;void 0!=b&&0!=b&&void 0!=d&&0!=d||console.error("Width/Height of the game element is 0! ");console.log(b+
"/"+d);var g=new THREE.Scene;c.three.scene=g;var f=new THREE.PerspectiveCamera(75,b/d,.1,1E3);f.position.z=5;g.add(f);var h=new THREE.AmbientLight(1092);console.log(h);g.add(h);var e=new THREE.WebGLRenderer({antialias:!0});e.setPixelRatio(b/d);e.setSize(b,d);c.element.appendChild(e.domElement);e.domElement.style.width="100%";e.domElement.style.height="100%";c.three.renderer=e;c.renderer={camera:f,ambient:h,WebGLRenderer:e};a()};this.save=function(){this.save=!0;return JSON.stringify(this)};this.load=
function(a){a=JSON.parse(a);for(var b in a)this[b]=a[b]}}Ember.quaternions=!1;Ember.Color=function(a,b,c,d){this.r=255;this.g=86;this.b=0;this.a=1;void 0!=a&&void 0!=b&&void 0!=c&&void 0!=d?(this.r=a,this.g=b,this.b=c,this.a=d):void 0!=a&&void 0!=b&&void 0!=c?(this.r=a,this.g=b,this.b=c):void 0!=a&&(void 0!=Ember.Util.Color?(a=Ember.Util.Color.fromHex(a),this.r=a.r,this.g=a.g,this.b=a.b):console.error("Hex input to the Ember.Color constructor is currently not supported due to the color utilities modules not being included"));this.toHex=function(){if(void 0!=Ember.Util.Color)return Ember.Util.Color.toHex(this.r,
this.g,this.b);console.error("Hex output from Ember.Color is currently not supported due to the color utilities modules not being included")}};Ember.GameObject=function(){var a=this;this.name="New GameObject";this.layer=0;this.tags=[];this.active=!0;this.mesh={};this.material={};this.scripts=[];this._tmesh=function(){if(a.material instanceof Ember.Material)return new THREE.Mesh(a.mesh,a.material._tmat());if(a.material instanceof THREE.Material)return new THREE.Mesh(a.mesh,a.material)};this.position=new Ember.Vector3;this.rotation=Ember.quaternions?new Ember.Vector3:new THREE.Quaternion;this.scale=new Ember.Vector3};
Ember.GameObject.Box=function(a,b,c){var d=new Ember.GameObject;d.mesh=void 0!=a&&void 0!=b&&void 0!=c?new THREE.BoxGeometry(a,b,c):void 0!=a?new THREE.BoxGeometry(a,a,a):new THREE.BoxGeometry(1,1,1);d.material=new THREE.MeshPhongMaterial;return d};Ember.Material=function(){var a=this;this.name="New Scene";this.shader=void 0;this.Events={};this.Events.OnChange=[];this.setShader=function(b){this.shader=b;this.Events.OnChange.forEach(function(b){void 0!=a._t&&a._tmat();b(a)})};this.texture=null;this.setTexture=function(b){this.texture=b;this.Events.OnChange.forEach(function(c){void 0!=a._t&&void 0!=a._t.map&&(a._t.map=b);c(a)})};this.color=new Ember.Color(255,255,255);this.setColor=function(b){b instanceof Ember.Color?(this.color=b,void 0!=a._t&&
(console.log("mat exists.."),void 0!=a._t.color&&(console.log("color exists.."),a._t.color.setRGB(b.r,b.g,b.b))),this.Events.OnChange.forEach(function(b){b(a)})):console.error("Passed wrong instance type to Ember.Material.color")};this.renderside=THREE.FrontSide;this.setRenderside=function(b){this.renderside=b;this.Events.OnChange.forEach(function(b){void 0!=a._t&&void 0!=a._t.side&&(a._t.side=a.renderside);b(a)})};this.override=void 0;this.setOverride=function(b){this.override=b;this.Events.OnChange.forEach(function(b){void 0!=
a._t&&a._tmat();b(a)})};this._tmat=function(){if(void 0!=a.override)return a.override;a._t=void 0!=a.shader?new THREE.ShaderMaterial({fragmentShader:a.shader.fragmentShader,vertexShader:a.shader.vertexShader,uniforms:a.shader.uniforms,depthWrite:!1,side:a.renderside}):new THREE.MeshBasicMaterial({color:a.color.toHex(),map:a.texture});return a._t}};
Ember.Material.Skybox=function(a,b){var c=new Ember.Material;c.name="Sky";var d=THREE.ImageUtils.loadTextureCube(a,void 0,function(){c.texture=d;var a=THREE.ShaderLib.cube;THREE.UniformsUtils.clone(a.uniforms);a.uniforms.tCube.value=d;c.shader=a;c.renderSide=THREE.BackSide;null!=b&&b(c)});return c};
Ember.Material.LoadRemote=function(a,b){var c={loaded:!1,progress:0,error:!1,material:d},d=new Ember.Material;d.name="Loaded Material";THREE.MaterialLoader.load(a,function(a){c.loaded=!0;d.override=a;void 0!=b&&b(d)},function(a){c.progress=a.loaded/a.total*100;console.log(a.loaded/a.total*100+"% loaded")},function(){c.error=!0});return c};Ember.Scene=function(){this.name="New Scene";this.objects=[];this.enviroment=new function(){this.ambientColor=3549;this.background={type:1,color:963304,skybox:new Ember.Material.Skybox("img/sky/posx.jpg img/sky/negx.jpg img/sky/posy.jpg img/sky/negy.jpg img/sky/posz.jpg img/sky/negz.jpg".split(" "))}};this.Events={};this.Events.ObjectAdded=[];this.add=function(a){this.objects.push(a);this.Events.ObjectAdded.forEach(function(b){b(a)})}};Ember.Vector3=function(a,b,c){this.z=this.y=this.x=0;void 0!=a&&void 0!=b&&void 0!=c?(this.x=a,this.y=b,this.z=c):void 0!=a&&(this.z=this.y=this.x=a);this.set=function(a,b,c){void 0!=a&&void 0!=b&&void 0!=c&&(this.x=a,this.y=b,this.z=c);return this}};Ember.Util={};Ember.Util.Color={fromHex:function(a){return hexToRgb(a)},toHex:function(a,b,c){return rgbToHex(a,b,c)}};function componentToHex(a){a=a.toString(16);return 1==a.length?"0"+a:a}function rgbToHex(a,b,c){return"#"+componentToHex(a)+componentToHex(b)+componentToHex(c)}
function hexToRgb(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,k){return c+c+d+d+k+k});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null};
